(this["webpackJsonpcounter-app"]=this["webpackJsonpcounter-app"]||[]).push([[0],{112:function(e,t,a){},113:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(11),c=a.n(o),l=a(123),s=a(3),u=a(4),i=a(6),m=a(5),d=a(124),p=a(50),h=a(122),v=a(20),b=a(120),f=function(e){var t=e.user;return r.a.createElement("nav",{className:"navbar navbar-expand-lg bg-light"},r.a.createElement("div",{className:"container-fluid"},r.a.createElement(b.a,{className:"navbar-brand",to:"/home"},"Aswar"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNavAltMarkup"},r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(b.a,{className:"nav-link ","aria-current":"page",to:"/products"},"Products"),!t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{className:"nav-link",to:"/login"},"Login"),r.a.createElement(b.a,{className:"nav-link",to:"/register"},"Register")),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{className:"nav-link",to:"/profile"},"Hi ".concat(t.name)),r.a.createElement(b.a,{className:"nav-link",to:"/logout"},"Logout"))))))},g=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Home Page"),!this.props.user&&r.a.createElement("div",null,r.a.createElement("p",null,"Please log in if you have an account or register if you have not."),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("p",null,"Admin user ==> username: ",r.a.createElement("b",null,"user1@domain.com")," \xa0 \xa0 \xa0 password:",r.a.createElement("b",null,"1234")),r.a.createElement("p",null,"Common user ==> username: ",r.a.createElement("b",null,"user2@domain.com")," \xa0 \xa0 \xa0 password:",r.a.createElement("b",null,"1234"))))}}]),a}(r.a.Component),E=a(7),k=a.n(E),O=a(12),j=a(14),y=a(16),w=a.n(y);w.a.defaults.baseURL="https://aswar-task.herokuapp.com/api",w.a.interceptors.response.use(null,(function(e){return e.response&&e.response.status>=500&&(console.log("Logging the error: ",e),v.b.error("An unexpected error occurred.")),Promise.reject(e)}));var C={get:w.a.get,post:w.a.post,put:w.a.put,delete:w.a.delete,setToken:function(e){w.a.defaults.headers.common["x-auth-token"]=e}};function N(e){return C.get("".concat("/products","/").concat(e))}function S(e){if(e.product_id){var t=Object(j.a)({},e);return delete t.product_id,C.put("/products/"+e.product_id,t)}return C.post("/products",e)}function x(e){return C.delete("".concat("/products","/").concat(e))}var D=a(30),_=a(49),P=a(46),T=a.n(P),A=function(e){var t=e.product,a=e.onClick,o=Object(n.useState)(""),c=Object(_.a)(o,2),l=c[0],s=c[1];return Object(n.useEffect)((function(){T.a.toDataURL("Name: ".concat(t.name,"\n    Price: ").concat(t.price,"\n    Creation Date: ").concat(t.creationDate)).then((function(e){s(e)}))}),[]),r.a.createElement("div",null,r.a.createElement("img",{src:l,onClick:function(){return a(t)},className:"clickable"}))},F=a(31),M=a.n(F);function R(){return(R=Object(O.a)(k.a.mark((function e(t,a){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.post("/logins",{email:t,password:a});case 2:n=e.sent,r=n.data,localStorage.setItem("token",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return localStorage.getItem("token")}C.setToken(I());var L={login:function(e,t){return R.apply(this,arguments)},loginWithToken:function(e){localStorage.setItem("token",e)},logout:function(){localStorage.removeItem("token")},getCurrentUser:function(){try{var e=localStorage.getItem("token");return M()(e)}catch(t){return null}},getToken:I,isAdmin:function(){try{var e=localStorage.getItem("token");return"admin"===M()(e).role}catch(t){return null}}},U=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.products,a=e.onDelete,n=e.onShow,o=e.onClose;return r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Price"),r.a.createElement("th",null,"Creation Date"),r.a.createElement("th",null),r.a.createElement("th",null,"QRCode"))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e.product_id},r.a.createElement("td",null,e.product_id),r.a.createElement("td",null,r.a.createElement(D.a,{to:"/products/".concat(e.product_id)},e.name)),r.a.createElement("td",null,e.price),r.a.createElement("td",null,e.creation_date),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return a(e)},className:"btn btn-danger btn-sm"},"Delete")),L.isAdmin()&&r.a.createElement("td",null,r.a.createElement(A,{product:e,onClick:function(){return n(e)},onClose:o})))}))))}}]),a}(r.a.Component),q=a(21),V=function(e){var t=e.data,a=e.visisble,n=e.onClose;return r.a.createElement(q.b,{isOpen:a,fade:!1},r.a.createElement(q.e,null,"QRCode Information:"),r.a.createElement(q.c,null,r.a.createElement("ul",null,Object.keys(t).map((function(e){return r.a.createElement("li",{key:e},"".concat(e,": ").concat(t[e]))})))),r.a.createElement(q.d,null,r.a.createElement(q.a,{onClick:n},"Close")))},W=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={products:[],product:{},modalVisible:!1},e.toggleModal=function(){var t=e.state.modalVisible;e.setState({modalVisible:!t})},e.handleDelete=function(){var t=Object(O.a)(k.a.mark((function t(a){var n,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.products,r=e.state.products.filter((function(e){return e.product_id!==a.product_id})),e.setState({products:r}),t.prev=3,t.next=6,x(a.product_id);case 6:t.next=12;break;case 8:t.prev=8,t.t0=t.catch(3),t.t0.response&&404===t.t0.response.status&&v.b.error("This product was not found."),e.setState({products:n});case 12:case"end":return t.stop()}}),t,null,[[3,8]])})));return function(e){return t.apply(this,arguments)}}(),e.toggleModal=function(){var t=e.state.modalVisible;e.setState({modalVisible:!t})},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=Object(O.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.get("/products");case 2:t=e.sent,a=t.data,this.setState({products:a});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.products.length;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{to:"/products/new",className:"btn btn-primary mb-1"},"Add New Product"),r.a.createElement("p",null,"Showing ",t," products in the database"),r.a.createElement(U,{products:this.state.products,onDelete:this.handleDelete,onShow:function(t){e.toggleModal(),e.setState({product:t})}}),r.a.createElement(V,{data:this.state.product,visisble:this.state.modalVisible,onClose:this.toggleModal}))}}]),a}(r.a.Component),H=a(10),Y=a.n(H),K=a(48),B=a(22),J=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{},errors:{}},e.validateField=function(t){var a=t.name,n=t.value,r=Object(B.a)({},a,n),o=Object(B.a)({},a,e.schema[a]),c=Y.a.validate(r,o).error;return c?c.details[0].message:null},e.handleChange=function(t){var a=Object(j.a)({},e.state.errors),n=e.validateField(t.currentTarget);n?a[t.currentTarget.name]=n:delete a[t.currentTarget.name];var r=Object(j.a)({},e.state.data);r[t.currentTarget.name]=t.currentTarget.value,e.setState({data:r,errors:a})},e.handleRadioChange=function(t){var a=Object(j.a)({},e.state.data);a.role=t.target.value,e.setState({data:a}),console.log(t.target.value)},e.handleSubmit=function(t){t.preventDefault();var a=e.validateForm();e.setState({errors:a||{}}),a||e.doSubmit()},e}return Object(u.a)(a,[{key:"validateForm",value:function(){var e={},t=Y.a.validate(this.state.data,this.schema,{abortEarly:!1});if(!t.error)return null;var a,n=Object(K.a)(t.error.details);try{for(n.s();!(a=n.n()).done;){var r=a.value;e[r.path[0]]=r.message}}catch(o){n.e(o)}finally{n.f()}return e}}]),a}(r.a.Component),Q=function(e){var t=e.name,a=e.value,n=e.label,o=e.error,c=e.onChange;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:t,className:"for"},n),r.a.createElement("input",{value:a,onChange:c,id:t,name:t,type:"text",className:"form-control"}),o&&r.a.createElement("div",{className:"alert alert-danger"},o))},z=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{name:"",price:"",creationDate:""},errors:{}},e.schema={product_id:Y.a.number(),name:Y.a.string().required(),price:Y.a.number().required(),creationDate:Y.a.date().required()},e.mapToProductModel=function(e){return{product_id:e.product_id,name:e.name,price:e.price,creationDate:e.creation_date}},e.doSubmit=Object(O.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S(e.state.data);case 2:e.props.history.push("/products");case 3:case"end":return t.stop()}}),t)}))),e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=Object(O.a)(k.a.mark((function e(){var t,a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("new"!==(t=this.props.match.params.id)){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,N(t);case 6:a=e.sent,n=a.data,this.setState({data:this.mapToProductModel(n)}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),e.t0.response&&404===e.t0.response.status&&this.props.history.replace("/not-found");case 14:case"end":return e.stop()}}),e,this,[[3,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.data,a=e.errors;return r.a.createElement("div",null,r.a.createElement("h1",null,"Product Form - ",this.props.match.params.id),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(Q,{value:t.name,onChange:this.handleChange,name:"name",label:"Name",error:a.name}),r.a.createElement(Q,{value:t.price,onChange:this.handleChange,name:"price",label:"Price",error:a.price}),r.a.createElement("small",{className:"mt-3"},"date format should be YYYY-MM-DD"),r.a.createElement(Q,{value:t.creationDate,onChange:this.handleChange,name:"creationDate",label:"Creation Date",error:a.creationDate}),r.a.createElement("button",{className:"btn btn-primary",disabled:this.validateForm()},"Save")))}}]),a}(J),G=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{email:"",password:""},errors:{}},e.schema={email:Y.a.string().email().required(),password:Y.a.string().required()},e}return Object(u.a)(a,[{key:"doSubmit",value:function(){var e=Object(O.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.state.data,e.next=4,L.login(t.email,t.password);case 4:window.location="/",e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),e.t0.response&&404===e.t0.response.status&&((a=Object(j.a)({},this.state.errors)).email=e.t0.response.data,this.setState({errors:a}));case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.data,a=e.errors;return r.a.createElement("div",null,r.a.createElement("h1",null,"Login"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement(Q,{value:t.email,onChange:this.handleChange,name:"email",label:"Email",error:a.email}),r.a.createElement(Q,{value:t.password,onChange:this.handleChange,name:"password",label:"Password",error:a.password})),r.a.createElement("button",{className:"btn btn-primary",disabled:this.validateForm()},"Login")))}}]),a}(J),X=function(e){var t=e.name,a=e.label,n=e.value,o=e.checked;return r.a.createElement("div",{className:"form-check"},r.a.createElement("input",{className:"form-check-input",type:"radio",name:t,value:n,id:t,checked:o}),r.a.createElement("label",{className:"form-check-label",htmlFor:t},a))};var Z=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{name:"",email:"",password:"",role:"common"},errors:{}},e.schema={name:Y.a.string().required(),email:Y.a.string().email().required(),password:Y.a.string().required(),role:Y.a.string().required()},e}return Object(u.a)(a,[{key:"doSubmit",value:function(){var e=Object(O.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n=this.state.data,C.post("/users",{email:n.email,password:n.password,name:n.name,role:n.role});case 3:t=e.sent,L.loginWithToken(t.headers["x-auth-token"]),window.location="/",e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),e.t0.response&&400===e.t0.response.status&&((a=Object(j.a)({},this.state.errors)).email=e.t0.response.data,this.setState({errors:a}));case 11:case"end":return e.stop()}var n}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.data,a=e.errors;return r.a.createElement("div",null,r.a.createElement("h1",null,"Register"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement(Q,{value:t.name,onChange:this.handleChange,name:"name",label:"Name:",error:a.name}),r.a.createElement(Q,{value:t.email,onChange:this.handleChange,name:"email",label:"Email:",error:a.email}),r.a.createElement(Q,{value:t.password,onChange:this.handleChange,name:"password",label:"Password:",error:a.password}),r.a.createElement("div",{className:"radio",onChange:this.handleRadioChange},r.a.createElement(X,{name:"admin",value:"admin",label:"Admin User",checked:"admin"===t.role}),r.a.createElement(X,{name:"common",value:"common",label:"Common User",checked:"common"===t.role}))),r.a.createElement("button",{className:"btn btn-primary my-2",disabled:this.validateForm()},"Register")))}}]),a}(J),$=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){L.logout(),window.location="/home"}},{key:"render",value:function(){return null}}]),a}(r.a.Component),ee=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"User Profile"))}}]),a}(r.a.Component),te=function(){return r.a.createElement("h1",null,"Page Not Found")},ae=(a(110),function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=L.getCurrentUser();this.setState({user:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,null),r.a.createElement(f,{user:this.state.user}),r.a.createElement("main",{className:"container"},r.a.createElement(d.a,null,r.a.createElement(p.a,{path:"/home",render:function(t){return r.a.createElement(g,Object.assign({},t,{user:e.state.user}))}}),r.a.createElement(p.a,{path:"/products/:id",component:z}),r.a.createElement(p.a,{path:"/products",component:W}),r.a.createElement(p.a,{path:"/login",component:G}),r.a.createElement(p.a,{path:"/register",component:Z}),r.a.createElement(p.a,{path:"/logout",component:$}),r.a.createElement(p.a,{path:"/profile",component:ee}),r.a.createElement(h.a,{from:"/",exact:!0,to:"/products"}),r.a.createElement(p.a,{path:"/not-found",component:te}),r.a.createElement(h.a,{to:"/not-found"}))))}}]),a}(n.Component));a(111),a(112);console.log(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_API_URL:"https://aswar-task.herokuapp.com/api"})),c.a.render(r.a.createElement(l.a,null,r.a.createElement(ae,null)),document.getElementById("root"))},54:function(e,t,a){e.exports=a(113)}},[[54,1,2]]]);
//# sourceMappingURL=main.9036e95a.chunk.js.map